<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Panel de tráfico en peajes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="page-header">
    <h1>Panel de tráfico en peajes</h1>
    <p>Gráficos construidos a partir de <code>resumen_graficas.json</code></p>
  </header>

  <div class="layout">
    <!-- Sidebar de navegación -->
    <nav class="sidebar">
      <h2 class="sidebar-title">Secciones</h2>
      <button class="nav-button active" data-target="view-eda">
        Análisis exploratorio
      </button>
      <button class="nav-button" data-target="view-models">
        Modelos predictivos
      </button>
      <button class="nav-button" data-target="view-mockup">
        Mock up
      </button>
      <button class="nav-button" data-target="view-operator">
        Interfaz del operario
      </button>
    </nav>

    <!-- Contenido principal (cambia según la vista) -->
    <main class="main-content">
      <!-- Vista 1: Análisis exploratorio -->
      <section id="view-eda" class="view-section active">
        <div class="container">
          <div id="error" class="error-message" style="display: none;">
            No se pudo cargar <code>resumen_graficas.json</code>. Verifica que exista
            en la misma carpeta que este archivo HTML.
          </div>

          <section class="grid">
            <!-- Gráfico 1 -->
            <article class="card">
              <h2>Tráfico mensual total</h2>
              <p>Evolución del tráfico total (Sentido 1+2 con exentos) para todos los peajes.</p>

              <!-- Selector de año -->
              <div class="year-switch">
                <label for="yearSelect">Año:&nbsp;</label>
                <select id="yearSelect"></select>
              </div>

              <div class="chart-wrapper">
                <canvas id="chart1"></canvas>
              </div>
            </article>

            <!-- Gráfico 2 -->
            <article class="card">
              <h2>Top 10 peajes por tráfico</h2>
              <p>Peajes con mayor tráfico acumulado (Sentido 1+2 con exentos).</p>
              <div class="chart-wrapper">
                <canvas id="chart2"></canvas>
              </div>
            </article>

            <!-- Gráfico 3 -->
            <article class="card">
              <h2>Distribución de exentos</h2>
              <p>Proporción de vehículos exentos por categoría (I–VII).</p>
              <div class="chart-wrapper">
                <canvas id="chart3"></canvas>
              </div>
            </article>
          </section>
        </div>
      </section>

      <!-- Vista 2: Modelos predictivos -->
      <section id="view-models" class="view-section">
        <div class="container">
          <section class="grid grid-models">
            <!-- 1. Resumen de modelos -->
            <article class="card">
              <h2>Resumen de modelos</h2>
              <p>
                Desempeño global de los modelos de árboles de decisión/XGBoost
                entrenados para cada peaje y sentido.
              </p>
              <div id="models-summary-text" class="small-text">
                Cargando resumen de modelos...
              </div>

              <!-- Selector de vista / peaje / sentido -->
              <div class="selector-row models-selector-row">
                <div class="trafico-mode-row models-mode-row">
                  <label for="models-mode">Vista:&nbsp;</label>
                  <select id="models-mode">
                    <option value="general">General (todos los peajes)</option>
                    <option value="peaje-sentido">Por peaje y sentido</option>
                  </select>
                </div>
                <div class="peaje-select-row models-peaje-row" style="display: none;">
                  <label for="models-peaje-select">Peaje:&nbsp;</label>
                  <select id="models-peaje-select"></select>
                </div>
                <div class="sentido-select-row models-sentido-row" style="display: none;">
                  <label for="models-sentido-select">Sentido:&nbsp;</label>
                  <select id="models-sentido-select">
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>
              </div>

              <div class="chart-wrapper">
                <canvas id="models-summary-chart"></canvas>
              </div>
            </article>

            <!-- 2. Datos de trafico_limpio -->
            <article class="card">
              <h2>Datos de tráfico (trafico_limpio)</h2>
              <p>
                Comportamiento agregado a partir de <code>trafico_limpio.csv</code>.
                Puedes ver un promedio general o filtrar por peaje y sentido.
              </p>
              <div id="trafico-summary" class="small-text">
                Cargando información de <code>trafico_limpio.csv</code>...
              </div>

              <!-- Selector de vista / peaje / sentido -->
              <div class="selector-row trafico-selector-row">
                <div class="trafico-mode-row">
                  <label for="trafico-mode">Vista:&nbsp;</label>
                  <select id="trafico-mode">
                    <option value="general">General (todos los peajes)</option>
                    <option value="peaje-sentido">Por peaje y sentido</option>
                  </select>
                </div>
                <div class="peaje-select-row trafico-peaje-row" style="display: none;">
                  <label for="trafico-peaje-select">Peaje:&nbsp;</label>
                  <select id="trafico-peaje-select"></select>
                </div>
                <div class="sentido-select-row trafico-sentido-row" style="display: none;">
                  <label for="trafico-sentido-select">Sentido:&nbsp;</label>
                  <select id="trafico-sentido-select">
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>
              </div>

              <div class="chart-wrapper">
                <canvas id="trafico-chart"></canvas>
              </div>
            </article>

            <!-- 3. Modelo por peaje y sentido -->
            <article class="card">
              <h2>Detalle de modelo por peaje</h2>
              <p>
                Selecciona un peaje y un sentido para ver las métricas del modelo y
                una comparación visual entre valores reales y predichos.
              </p>

              <div class="selector-row">
                <div class="peaje-select-row">
                  <label for="peaje-select">Peaje:&nbsp;</label>
                  <select id="peaje-select"></select>
                </div>
                <div class="sentido-select-row">
                  <label for="sentido-select">Sentido:&nbsp;</label>
                  <select id="sentido-select">
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>
              </div>

              <div id="peaje-model-summary" class="small-text">
                Selecciona un peaje para ver su modelo.
              </div>

              <div class="chart-wrapper">
                <canvas id="peaje-model-chart"></canvas>
              </div>
            </article>
          </section>
        </div>
      </section>

      <!-- Vista 3: Mock up -->
      <section id="view-mockup" class="view-section">
        <div class="container">
          <div class="placeholder-card mockup-area">
            <h2>Mock up de la solución</h2>
            <p>
              Esta sección está reservada para el mock up de la interfaz o prototipo
              de la herramienta que visualizará o gestionará los datos de tráfico.
            </p>
            <p class="placeholder-note">
              Más adelante podrás incrustar:
            </p>
            <ul class="placeholder-list">
              <li>Capturas o imágenes del mock up.</li>
              <li>Un iframe con un prototipo interactivo (Figma, HTML, etc.).</li>
              <li>Componentes de UI ya implementados en HTML/CSS/JS.</li>
            </ul>
            <div class="mockup-placeholder-box">
              Área reservada para el mock up<br />
              (imagen, iframe, componentes, etc.)
            </div>
          </div>
        </div>
      </section>

      <!-- Vista 4: Interfaz del operario -->
      <section id="view-operator" class="view-section">
        <div class="container">
          <article class="card">
            <h2>Interfaz del operario</h2>
            <p>
              Selecciona un peaje y un mes para estimar cuántos carriles deben quedar
              habilitados en cada sentido, a partir de los modelos de tráfico entrenados.
            </p>

            <div class="selector-row">
              <div class="peaje-select-row">
                <label for="operator-peaje-select">Peaje:&nbsp;</label>
                <select id="operator-peaje-select"></select>
              </div>
              <div class="sentido-select-row">
                <label for="operator-month-select">Mes:&nbsp;</label>
                <select id="operator-month-select"></select>
              </div>
            </div>

            <div id="operator-result-text" class="small-text" style="margin-top: 0.5rem;">
              Cargando datos de modelos para la interfaz del operario...
            </div>

            <div class="chart-wrapper">
              <canvas id="operator-chart"></canvas>
            </div>
          </article>
        </div>
      </section>
    </main>
  </div>

  <footer>
    Datos consolidados multi-año · Proyecto peajes UTPN
  </footer>

  <!-
